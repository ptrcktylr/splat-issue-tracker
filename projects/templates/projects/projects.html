{% extends 'layouts/base.html' %}

{% block title %} Projects {% endblock title %}

{% block content %}

    <!-- Header -->
    <div class="header bg-gradient-primary pb-8 pt-5 pt-md-8">
    </div>

    <div class="container-fluid mt--7">

      <div class="row">
        <div class="col-xl mb-5 mb-xl-0">
          <!-- TODO: create project button, maybe only have people allowed to create able to see -->
          <a type="button" href="/project/new/" class="btn btn-secondary btn-lg btn-block mb-4">Create New Project</a>
          <div class="card bg-gradient-default shadow">
            <div class="card-header bg-transparent">
              <div class="row align-items-center">
                <div class="col">
                  <h6 class="text-uppercase text-light ls-1 mb-1">Overview</h6>
                  <h2 class="text-white mb-0">My Projects</h2>
                </div>
              </div>
            </div>
            <!-- Table -->
            <div class="table-responsive">
              <table class="table align-items-center table-dark">
                <!-- Table Headers -->
                <thead class="thead-dark">
                  <tr>
                    <th scope="col">
                        Project
                    </th>
                    <th scope="col">
                        Open Tickets
                    </th>
                    <th scope="col">
                      Project Managers
                    </th>
                    <th scope="col">
                      Assigned Developers
                    </th>
                    <th scope="col"></th>
                  </tr>
                </thead>

                <!-- Table Body -->
                <tbody class="list">
                  <!-- Table Item -->
                  {% for project in projects %}
                  <tr>
                    <!-- Project Name & Image -->
                    <th scope="row" class="name">
                      <a href="{% url 'project-detail' project.id %}" class="mb-0 text-sm text-white">{{ project.name }}</a>
                    </th>
                    <!-- Open Tickets -->
                    <td class="open-tickets">
                      {{ project.num_open_tickets }}
                    </td>
                    <!-- Project Managers -->
                    <td>
                      <div class="avatar-group">
                        {% for manager in project.get_assigned_managers %}
                        <a href="#" class="avatar avatar-sm" data-toggle="tooltip" data-original-title="{{manager.first_name}} {{manager.last_name}}">
                          <img alt="Image placeholder" 
                          src="https://demos.creative-tim.com/argon-dashboard-django/assets/img/dashboard/free/theme/team-1-800x800.jpg" class="rounded-circle">
                        </a>
                        {% endfor %}
                      </div>
                    </td>
                    <!-- Assigned Developers -->
                    <td>
                      <div class="avatar-group">
                        {% for dev in project.get_assigned_devs %}
                        <a href="#" class="avatar avatar-sm" data-toggle="tooltip" data-original-title="{{dev.first_name}} {{dev.last_name}}">
                          <img alt="Image placeholder" 
                          src="https://demos.creative-tim.com/argon-dashboard-django/assets/img/dashboard/free/theme/team-1-800x800.jpg" class="rounded-circle">
                        </a>
                        {% endfor %}
                      </div>
                    </td>
                    <td class="text-right">
                      <div class="dropdown">
                          <a class="btn btn-sm btn-icon-only text-light" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-ellipsis-v"></i>
                          </a>
                          <div class="dropdown-menu dropdown-menu-right dropdown-menu-arrow">
                              <a class="dropdown-item" href="{% url 'project-detail' project.id %}">More Details</a>
                          </div>
                      </div>
                  </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
          
        </div>
      </div>

      {% include "includes/footer.html" %}

    </div>

{% endblock content %}

<!-- Specific JS goes HERE --> 
{% block javascripts %}{% endblock javascripts %}
